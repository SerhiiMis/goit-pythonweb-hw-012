# Contacts API

A secure asynchronous REST API for managing personal contacts, built with FastAPI, PostgreSQL, JWT, Docker, and Redis.

## ğŸš€ Features

- âœ… JWT-based authentication and email verification
- âœ… Rate limiting for protected endpoints
- âœ… Cloudinary avatar uploads
- âœ… Contact CRUD operations
- âœ… Upcoming birthdays filter
- âœ… Role-based access control (`user` / `admin`)
- âœ… Password reset flow via email
- âœ… Redis caching for user session
- âœ… Full async support with FastAPI + SQLAlchemy
- âœ… Dockerized with PostgreSQL and Redis
- âœ… 79%+ test coverage with `pytest`

## ğŸ› ï¸ Technologies

- Python 3.12+
- FastAPI
- SQLAlchemy (async)
- PostgreSQL + asyncpg
- Redis
- Docker & Docker Compose
- Cloudinary
- pytest / pytest-asyncio / pytest-cov
- Pydantic v2
- Uvicorn
- python-jose
- Alembic

## ğŸ“¦ Getting Started

### 1. Clone the repository

```bash
git clone https://github.com/SerhiiMis/goit-pythonweb-hw-012.git
cd goit-pythonweb-hw-012
```

### 2. Create `.env`

```env
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/contacts_db
SECRET_KEY=your_secret_key

CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

REDIS_URL=redis://redis:6379/0
FRONTEND_URL=http://localhost:3000
```

### 3. Run the project

```bash
docker-compose up --build
```

Access the API docs at:  
ğŸ“„ Swagger UI â†’ [http://localhost:8000/docs](http://localhost:8000/docs)

---

## ğŸ“š API Overview

### ğŸ” Authentication

| Method | Endpoint                       | Description             |
| ------ | ------------------------------ | ----------------------- |
| POST   | `/auth/signup`                 | Register a user         |
| POST   | `/auth/login`                  | Login and receive JWT   |
| GET    | `/auth/verify-email`           | Email verification link |
| POST   | `/auth/request-reset-password` | Request password reset  |
| POST   | `/auth/reset-password`         | Reset password          |

### ğŸ‘¤ Users

| Method | Endpoint        | Description                |
| ------ | --------------- | -------------------------- |
| GET    | `/users/me`     | Get current user info      |
| POST   | `/users/avatar` | Upload avatar (Cloudinary) |

### ğŸ“‡ Contacts (auth required)

| Method | Endpoint                        | Description              |
| ------ | ------------------------------- | ------------------------ |
| POST   | `/contacts/`                    | Create contact           |
| GET    | `/contacts/`                    | Get all contacts         |
| GET    | `/contacts/{id}`                | Get contact by ID        |
| PUT    | `/contacts/{id}`                | Update contact           |
| DELETE | `/contacts/{id}`                | Delete contact           |
| GET    | `/contacts/search/?query=...`   | Search contacts          |
| GET    | `/contacts/upcoming-birthdays/` | Birthdays in next 7 days |

### ğŸ›¡ï¸ Admin

| Method | Endpoint       | Description                |
| ------ | -------------- | -------------------------- |
| GET    | `/admin/users` | Get all users (admin only) |

---

## ğŸ§ª Testing

Run tests and check coverage:

```bash
pytest --cov=app --cov-report=term-missing
```

Test coverage: **â‰¥ 79%**

---

## ğŸ“– Documentation

Autogenerated with Sphinx. To build docs:

```bash
cd docs
make html
```

Open `docs/_build/html/index.html` in a browser.

---

## ğŸ“‚ Project Structure

```
.
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ auth/              # Auth logic
â”‚   â”œâ”€â”€ routers/           # API routes
â”‚   â”œâ”€â”€ services/          # Redis, Cloudinary, Email
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ crud.py
â”‚   â”œâ”€â”€ database.py
â”‚   â”œâ”€â”€ main.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ tests/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
```

---

## ğŸ“ƒ License

MIT Â© 2025 Serhii Mishovych
